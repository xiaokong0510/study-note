<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Docker基本操作 | xiao blog</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/study-note/logo.png">
    <meta name="description" content="半路出家的 Java 学习之路">
    
    <link rel="preload" href="/study-note/assets/css/0.styles.0a4146bd.css" as="style"><link rel="preload" href="/study-note/assets/js/app.73f4c6b1.js" as="script"><link rel="preload" href="/study-note/assets/js/2.a46c0893.js" as="script"><link rel="preload" href="/study-note/assets/js/45.d7d79e6d.js" as="script"><link rel="prefetch" href="/study-note/assets/js/10.aaccd5cc.js"><link rel="prefetch" href="/study-note/assets/js/11.4de599e5.js"><link rel="prefetch" href="/study-note/assets/js/12.cd6110b6.js"><link rel="prefetch" href="/study-note/assets/js/13.cad829a6.js"><link rel="prefetch" href="/study-note/assets/js/14.35fa0f46.js"><link rel="prefetch" href="/study-note/assets/js/15.d3b8b744.js"><link rel="prefetch" href="/study-note/assets/js/16.6a6df8e5.js"><link rel="prefetch" href="/study-note/assets/js/17.c88bf5e2.js"><link rel="prefetch" href="/study-note/assets/js/18.65fb4eb6.js"><link rel="prefetch" href="/study-note/assets/js/19.27fe8d16.js"><link rel="prefetch" href="/study-note/assets/js/20.4dd48894.js"><link rel="prefetch" href="/study-note/assets/js/21.e98544c6.js"><link rel="prefetch" href="/study-note/assets/js/22.cddefbe9.js"><link rel="prefetch" href="/study-note/assets/js/23.bb942f73.js"><link rel="prefetch" href="/study-note/assets/js/24.87bb4e22.js"><link rel="prefetch" href="/study-note/assets/js/25.4188d361.js"><link rel="prefetch" href="/study-note/assets/js/26.16e9f79b.js"><link rel="prefetch" href="/study-note/assets/js/27.08d4bb87.js"><link rel="prefetch" href="/study-note/assets/js/28.d6954906.js"><link rel="prefetch" href="/study-note/assets/js/29.f3fd8ef7.js"><link rel="prefetch" href="/study-note/assets/js/3.e3bdc6b6.js"><link rel="prefetch" href="/study-note/assets/js/30.71f466a2.js"><link rel="prefetch" href="/study-note/assets/js/31.0e7a71ce.js"><link rel="prefetch" href="/study-note/assets/js/32.57017e2f.js"><link rel="prefetch" href="/study-note/assets/js/33.32710ab5.js"><link rel="prefetch" href="/study-note/assets/js/34.3109e812.js"><link rel="prefetch" href="/study-note/assets/js/35.29f89c82.js"><link rel="prefetch" href="/study-note/assets/js/36.030c89dc.js"><link rel="prefetch" href="/study-note/assets/js/37.da0e6229.js"><link rel="prefetch" href="/study-note/assets/js/38.833f7596.js"><link rel="prefetch" href="/study-note/assets/js/39.7c804afa.js"><link rel="prefetch" href="/study-note/assets/js/4.810a9dda.js"><link rel="prefetch" href="/study-note/assets/js/40.d60f7b1e.js"><link rel="prefetch" href="/study-note/assets/js/41.57cd3836.js"><link rel="prefetch" href="/study-note/assets/js/42.4c5bdf56.js"><link rel="prefetch" href="/study-note/assets/js/43.3cb66c19.js"><link rel="prefetch" href="/study-note/assets/js/44.cf2cc56e.js"><link rel="prefetch" href="/study-note/assets/js/46.7ea496c3.js"><link rel="prefetch" href="/study-note/assets/js/47.5d6934b8.js"><link rel="prefetch" href="/study-note/assets/js/48.2d82ee4c.js"><link rel="prefetch" href="/study-note/assets/js/49.be38f61a.js"><link rel="prefetch" href="/study-note/assets/js/5.7b7c443b.js"><link rel="prefetch" href="/study-note/assets/js/50.8341ad45.js"><link rel="prefetch" href="/study-note/assets/js/51.ad66aaaf.js"><link rel="prefetch" href="/study-note/assets/js/6.723ea6d4.js"><link rel="prefetch" href="/study-note/assets/js/7.33a4fc23.js"><link rel="prefetch" href="/study-note/assets/js/8.1342ed21.js"><link rel="prefetch" href="/study-note/assets/js/9.9b38a488.js">
    <link rel="stylesheet" href="/study-note/assets/css/0.styles.0a4146bd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/study-note/" class="home-link router-link-active"><img src="/study-note/logo.png" alt="xiao blog" class="logo"> <span class="site-name can-hide">xiao blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/study-note/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机基础" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study-note/pages/Computer Basics/computer network/" class="nav-link">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/study-note/pages/Computer Basics/operating systems/" class="nav-link">
  操作系统
</a></li></ul></div></div><div class="nav-item"><a href="/study-note/pages/DataStructures&amp;Algorithms/" class="nav-link">
  数据结构与算法
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study-note/pages/Java/basic/" class="nav-link">
  基础
</a></li><li class="dropdown-item"><!----> <a href="/study-note/pages/Java/concurrent/" class="nav-link">
  并发
</a></li><li class="dropdown-item"><!----> <a href="/study-note/pages/Java/JVM/" class="nav-link">
  JVM
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study-note/pages/Databases/MySQL/" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/study-note/pages/Databases/Redis/" class="nav-link">
  Redis
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study-note/pages/Framework/SSM/" class="nav-link">
  SSM
</a></li><li class="dropdown-item"><!----> <a href="/study-note/pages/Framework/SpringBoot/" class="nav-link">
  SpringBoot
</a></li><li class="dropdown-item"><!----> <a href="/study-note/pages/Framework/SpringCloud/" class="nav-link">
  SpringCloud
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><span class="title">更多</span> <span class="arrow down"></span></button> <button type="button" aria-label="更多" class="mobile-dropdown-title"><span class="title">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study-note/pages/more/tools/" class="nav-link">
  工具
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/xiaokong0510" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/study-note/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机基础" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study-note/pages/Computer Basics/computer network/" class="nav-link">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/study-note/pages/Computer Basics/operating systems/" class="nav-link">
  操作系统
</a></li></ul></div></div><div class="nav-item"><a href="/study-note/pages/DataStructures&amp;Algorithms/" class="nav-link">
  数据结构与算法
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study-note/pages/Java/basic/" class="nav-link">
  基础
</a></li><li class="dropdown-item"><!----> <a href="/study-note/pages/Java/concurrent/" class="nav-link">
  并发
</a></li><li class="dropdown-item"><!----> <a href="/study-note/pages/Java/JVM/" class="nav-link">
  JVM
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow down"></span></button> <button type="button" aria-label="数据库" class="mobile-dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study-note/pages/Databases/MySQL/" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/study-note/pages/Databases/Redis/" class="nav-link">
  Redis
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study-note/pages/Framework/SSM/" class="nav-link">
  SSM
</a></li><li class="dropdown-item"><!----> <a href="/study-note/pages/Framework/SpringBoot/" class="nav-link">
  SpringBoot
</a></li><li class="dropdown-item"><!----> <a href="/study-note/pages/Framework/SpringCloud/" class="nav-link">
  SpringCloud
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><span class="title">更多</span> <span class="arrow down"></span></button> <button type="button" aria-label="更多" class="mobile-dropdown-title"><span class="title">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/study-note/pages/more/tools/" class="nav-link">
  工具
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/xiaokong0510" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="docker-基本操作"><a href="#docker-基本操作" class="header-anchor">#</a> Docker 基本操作</h1> <p>Docker基本知识，包括：</p> <ul><li><p>镜像与容器的概念</p></li> <li><p>安装与启动</p></li> <li><p>镜像与容器相关命令</p></li> <li><p>docker 部署Tomcat、Nginx 、MySQL、Redis</p></li></ul> <h2 id="_1-docker简介"><a href="#_1-docker简介" class="header-anchor">#</a> 1. Docker简介</h2> <blockquote><p>虚拟化</p></blockquote> <p>​	Virtualization，是一种资源管理技术，是将计算机的各种实体资源，如服务器、网络、内存及存储等，予以抽象、转换后呈现出来，打破实体结构间的不可切割的障碍，使用户可以比原本的组态更好的方式来应用这些资源。这些资源的新虚拟部份是不受现有资源的架设方式，地域或物理组态所限制。一般所指的虚拟化资源包括计算能力和资料存储。</p> <p>​	在实际的生产环境中，虚拟化技术主要用来解决高性能的物理硬件产能过剩和老的旧的硬件产能过低的重组重用，透明化底层物理硬件，从而最大化的利用物理硬件   对资源充分利用</p> <p>​	虚拟化技术种类很多，例如：软件虚拟化、硬件虚拟化、内存虚拟化、网络虚拟化(vip)、桌面虚拟化、服务虚拟化、虚拟机等等。</p> <blockquote><p>什么是Docker</p></blockquote> <p>Docker 项目的目标是实现轻量级的操作系统虚拟化解决方案。 Docker 的基础是 Linux 容器（LXC）等技术。</p> <p>项目地址： https://github.com/docker/docker</p> <p>特点：</p> <ol><li>启动快；去除了管理程序的开销同一台宿主机中也可以运行更多的容器，尽可能的充分利用系统资源。</li> <li>职责的逻辑分类；加强开发人员写代码的开发环境与应用程序要部署的生产环境一致性。</li> <li>可移植性，易于构建，并易于协作。</li> <li>鼓励使用面向服务的架构，推荐单个容器只运行一个应用程序或进程，形成了一个分布式的应用程序模型。</li></ol> <blockquote><p>Docker 镜像与容器</p></blockquote> <p>Docker是一个客户端-服务器（C/S）架构程序。Docker客户端只需要向Docker服务器或者守护进程发出请求，服务器或者守护进程将完成所有工作并返回结果Docker提供了一个命令行工具Docker以及一整套RESTful API。可以在同一台宿主机上运行Docker守护进程和客户端，也可以从本地的Docker客户端连接到运行在另一台宿主机上的远程Docker守护进程</p> <p><strong>镜像</strong>： 将镜像当作容器的“源代码”。镜像体积很小，非常“便携”，易于分享、存储和更新。</p> <p><strong>容器：</strong> 类似于集装箱</p> <p>**Registry： ** 镜像仓库，分为公共和私有两种。</p> <p>Docker公司运营公共的Registry：Docker Hub。https://hub.docker.com/</p> <p>也可以自己构建私有的Registry</p> <h2 id="_2-安装docker-yum安装"><a href="#_2-安装docker-yum安装" class="header-anchor">#</a> 2. 安装Docker（yum安装）</h2> <h3 id="_2-1-安装步骤"><a href="#_2-1-安装步骤" class="header-anchor">#</a> 2.1 安装步骤</h3> <ol><li><p>官网安装参考手册：https://docs.docker.com/install/linux/docker-ce/centos/</p></li> <li><p>确定是CentOS7及以上版本</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">cat</span> /etc/redhat-release  <span class="token comment">#查看版本</span>
CentOS Linux release <span class="token number">7.7</span>.1908 <span class="token punctuation">(</span>Core<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>yum安装gcc相关（需要确保 虚拟机可以上外网 ）</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>yum -y <span class="token function">install</span> gcc
yum -y <span class="token function">install</span> gcc-c++
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>卸载旧版本</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token variable">$yum</span> remove <span class="token function">docker</span> <span class="token punctuation">\</span>
                  docker-client <span class="token punctuation">\</span>
                  docker-client-latest <span class="token punctuation">\</span>
                  docker-common <span class="token punctuation">\</span>
                  docker-latest <span class="token punctuation">\</span>
                  docker-latest-logrotate <span class="token punctuation">\</span>
                  docker-logrotate <span class="token punctuation">\</span>
                  docker-engine
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p>安装需要的软件包</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>yum <span class="token function">install</span> -y yum-utils device-mapper-persistent-data lvm2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>设置stable镜像仓库</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 推荐使用国内的阿里云</span>
yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>更新yum软件包索引</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>yum makecache fast
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>安装最新版本Docker Engine和容器</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>yum -y <span class="token function">install</span> docker-ce docker-ce-cli containerd.io
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>启动并测试 hello-world</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#启动</span>
systemctl start <span class="token function">docker</span>   
<span class="token comment">#运行helloworld,会提示先在本地找没有这个镜像，然后拉取进镜像</span>
<span class="token function">docker</span> run hello-world
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>设置ustc的镜像</p> <p>ustc是老牌的linux镜像服务提供者：https://lug.ustc.edu.cn/wiki/mirrors/help/docker</p> <p>新建并编辑文件：</p></li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">vi</span> /etc/docker/daemon.json  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在该文件中输入如下内容：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">{</span>
<span class="token string">&quot;registry-mirrors&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">&quot;https://docker.mirrors.ustc.edu.cn&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>或者注册一个自己的阿里云账号，配置阿里云中的镜像加速器</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">mkdir</span> -p /etc/docker
<span class="token function">sudo</span> <span class="token function">tee</span> /etc/docker/daemon.json <span class="token operator">&lt;&lt;-</span><span class="token string">'EOF'
{
  &quot;registry-mirrors&quot;: [&quot;****&quot;]
}
EOF</span>
<span class="token function">sudo</span> systemctl daemon-reload 
<span class="token function">sudo</span> systemctl restart <span class="token function">docker</span>   <span class="token comment">#重启docker</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ol start="11"><li>docker相关操作</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#启动docker</span>
systemctl start <span class="token function">docker</span>  
<span class="token comment">#停止docker</span>
systemctl stop <span class="token function">docker</span>	
<span class="token comment">#重启docker</span>
systemctl restart <span class="token function">docker</span> 
<span class="token comment">#查看docker状态：</span>
systemctl status <span class="token function">docker</span>
<span class="token comment">#设置开机启动：</span>
systemctl <span class="token builtin class-name">enable</span> <span class="token function">docker</span>  
<span class="token comment"># 帮助命令,#查看docker版本</span>
<span class="token function">docker</span> verion 
<span class="token comment">#查看docker状态</span>
<span class="token function">docker</span> info   
<span class="token comment">#查看docker帮助文档</span>
<span class="token function">docker</span> --help 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="_2-2-镜像相关命令"><a href="#_2-2-镜像相关命令" class="header-anchor">#</a> 2.2 镜像相关命令</h3> <h4 id="_2-2-1-查看镜像"><a href="#_2-2-1-查看镜像" class="header-anchor">#</a> 2.2.1 查看镜像</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> images
<span class="token comment">#列出本地所有镜像(含中间映像层)</span>
<span class="token function">docker</span> images -a  
<span class="token comment">#只显示镜像ID</span>
<span class="token function">docker</span> images -q  
<span class="token comment">#显示镜像的摘要信息</span>
<span class="token function">docker</span> images --digests  
<span class="token comment">#显示完整的镜像信息</span>
<span class="token function">docker</span> images --no-trunc  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li>REPOSITORY：镜像名称， 唯一的</li> <li>TAG：镜像标签，如果不指定一个镜像的版本标签将默认使用latest 镜像</li> <li>IMAGE ID：镜像ID， 唯一的</li> <li>CREATED：镜像的创建日期（不是获取该镜像的日期）</li> <li>SIZE：镜像大小</li> <li>这些镜像都是存储在Docker宿主机的/var/lib/docker目录下</li></ul> <h4 id="_2-2-2-搜索镜像"><a href="#_2-2-2-搜索镜像" class="header-anchor">#</a> 2.2.2 搜索镜像</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#搜索某个镜像</span>
<span class="token function">docker</span> search 镜像名称  
<span class="token comment">#搜索点赞数超过30的镜像</span>
<span class="token function">docker</span> search -s <span class="token number">30</span> 镜像名称   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><p>NAME：仓库名称</p></li> <li><p>DESCRIPTION：镜像描述</p></li> <li><p>STARS：用户评价，反应一个镜像的受欢迎程度</p></li> <li><p>OFFICIAL：是否官方</p></li> <li><p>AUTOMATED：自动构建，表示该镜像由Docker Hub自动构建流程创建的</p></li></ul> <h4 id="_2-2-3-拉取镜像"><a href="#_2-2-3-拉取镜像" class="header-anchor">#</a> 2.2.3 拉取镜像</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code> <span class="token comment">#拉取某个镜像，等价于： docker pull 镜像名称：latest</span>
<span class="token function">docker</span> pull 镜像名称  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>还可以拉 dokcer pull centos ，只有不到200M的大小</li></ul> <h4 id="_2-2-4-删除镜像"><a href="#_2-2-4-删除镜像" class="header-anchor">#</a> 2.2.4 删除镜像</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code> <span class="token comment">#删除镜像，先删容器才能删镜像</span>
<span class="token function">docker</span> rmi  镜像ID<span class="token punctuation">(</span>或者镜像名<span class="token punctuation">)</span>  
 <span class="token comment">#强制删除</span>
<span class="token function">docker</span> rmi -f 镜像ID/<span class="token punctuation">(</span>或者镜像名<span class="token punctuation">)</span>  
<span class="token comment">#删除多个</span>
<span class="token function">docker</span> rmi -f 镜像名 镜像名 镜像名
<span class="token comment">#组合命令，删除所有镜像</span>
<span class="token function">docker</span> rmi -f <span class="token variable"><span class="token variable">$(</span><span class="token function">docker</span> images -q<span class="token variable">)</span></span>    
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_2-3-容器相关命令"><a href="#_2-3-容器相关命令" class="header-anchor">#</a> 2.3 容器相关命令</h3> <h4 id="_2-3-1-查看容器"><a href="#_2-3-1-查看容器" class="header-anchor">#</a> 2.3.1 查看容器</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>   <span class="token comment">#查看所有正在运行的容器</span>
   <span class="token function">docker</span> <span class="token function">ps</span> 		
   <span class="token comment">#查看所有容器,运行过的或者正在运行的</span>
   <span class="token function">docker</span> <span class="token function">ps</span> -a  	
   <span class="token comment">#查看最后一次运行的容器</span>
   <span class="token function">docker</span> <span class="token function">ps</span> –l 	
   <span class="token comment">#查看最近n个创建的容器</span>
   <span class="token function">docker</span> <span class="token function">ps</span> –n 数字	
   <span class="token comment">#静默模式，只显示容器编号</span>
   <span class="token function">docker</span> <span class="token function">ps</span> –q 	
   <span class="token comment">#查看停止的容器</span>
   <span class="token function">docker</span> <span class="token function">ps</span> -f <span class="token assign-left variable">status</span><span class="token operator">=</span>exited  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="_2-3-2-创建与启动容器"><a href="#_2-3-2-创建与启动容器" class="header-anchor">#</a> 2.3.2 创建与启动容器</h4> <ol><li>创建容器命令：</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> run  <span class="token punctuation">[</span>OPTIONS<span class="token punctuation">]</span>  image  <span class="token punctuation">[</span>COMMAND<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>[OPTIONS]说明：</strong></p> <ul><li><p>--name=&quot;容器新名字&quot;：为容器指定一个名称</p></li> <li><p>-d：后台运行容器，并返回去容器ID，即启动守护式容器（这样创建容器后不会自动登录容器，如果只加-i -t两个参数，创建后就会自动进去容器）。</p></li> <li><p>==-i：以交互模式运行容器，常与-t同时使用==</p></li> <li><p>==-t：表示容器启动后会进入其命令行。加入这两个参数后，容器创建就能登录进去。即分配一个伪终端。==</p></li> <li><p>-v：表示目录映射关系（前者是宿主机目录，后者是映射到宿主机上的目录），可以使用多个－v做多个目录或文件映射。注意：最好做目录映射，在宿主机上做修改，然后共享到容器上。</p></li> <li><p>-p：表示端口映射，前者是宿主机端口，后者是容器内的映射端口。可以使用多个-p做多个端口映射</p></li></ul> <ol start="2"><li>交互式方式创建容器：</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> run -it --name<span class="token operator">=</span>容器名称 镜像名称:标签 /bin/bash

<span class="token builtin class-name">exit</span>  <span class="token comment"># 退出并关闭当前容器</span>
Ctrl+Q+P   <span class="token comment"># 退出当前容器,并不停止</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ol start="3"><li>守护式方式创建容器：</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> run -d --name<span class="token operator">=</span>容器名称 镜像名称:标签

<span class="token comment">#登录守护式容器方式：</span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> -it 容器名称 <span class="token punctuation">(</span>或者容器ID<span class="token punctuation">)</span>  /bin/bash
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>【注意】：此时docker ps -a 进行查看, 会发现容器已经退出。</p> <p>Docker容器后台运行,就必须有一个前台进程。</p> <p>容器运行的命令如果不是那些一直挂起的命令（比如运行top，tail），就是会自动退出的。</p> <ol start="4"><li>停止与启动容器</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#停止容器：</span>
<span class="token function">docker</span> stop 容器名称（或者容器ID）
<span class="token comment">#强制停止容器：</span>
<span class="token function">docker</span> <span class="token function">kill</span> 容器名称（或者容器ID）
<span class="token comment">#启动容器：</span>
<span class="token function">docker</span> start 容器名称（或者容器ID）
<span class="token comment">#重启容器：</span>
<span class="token function">docker</span> restart 容器名称（或者容器ID）

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ol start="5"><li>删除容器</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>  <span class="token function">docker</span> <span class="token function">rm</span> 容器ID  <span class="token comment">#，删除容器</span>
  <span class="token function">docker</span> <span class="token function">rm</span> -f <span class="token variable"><span class="token variable">$(</span><span class="token function">docker</span> <span class="token function">ps</span> -aq<span class="token variable">)</span></span>  <span class="token comment">#一次性删除所有容器</span>
  <span class="token function">docker</span> pa -aq <span class="token operator">|</span> <span class="token function">xargs</span> <span class="token function">docker</span> <span class="token function">rm</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol start="6"><li>文件拷贝</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#拷进</span>
<span class="token function">docker</span> <span class="token function">cp</span> 需要拷贝的文件或目录 容器名称:容器目录
<span class="token comment">#拷出</span>
<span class="token function">docker</span> <span class="token function">cp</span> 容器名称:容器目录 需要拷贝的文件或目录
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_2-4-镜像补充命令"><a href="#_2-4-镜像补充命令" class="header-anchor">#</a> 2.4 镜像补充命令</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> commit <span class="token comment">#提交容器副本使之成为一个新的镜像</span>
<span class="token function">docker</span> commit -m<span class="token operator">=</span><span class="token string">&quot;描述信息&quot;</span> -a<span class="token operator">=</span><span class="token string">&quot;作者信息&quot;</span> 容器id 要创建的目标镜像名:<span class="token punctuation">[</span>标签名<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_2-5-docker容器数据卷"><a href="#_2-5-docker容器数据卷" class="header-anchor">#</a> 2.5 Docker容器数据卷</h3> <h4 id="_2-5-1-联合文件系统-union-file-system"><a href="#_2-5-1-联合文件系统-union-file-system" class="header-anchor">#</a> 2.5.1 联合文件系统(Union File System)</h4> <p>​		Docker镜像被存储在一系列的只读层。当开启一个容器，Docker读取只读镜像并添加一个读写层在顶部。如果正在运行的容器修改了现有的文件，该文件将被拷贝出底层的只读层到最顶层的读写层。在读写层中的旧版本文件隐藏于该文件之下，但并没有被不破坏 - 它仍然存在于镜像以下。当Docker的容器被删除，然后重新启动镜像时，将开启一个没有任何更改的新的容器 - 这些更改会丢失。此只读层及在顶部的读写层的组合被Docker称为联合文件系统</p> <h4 id="_2-5-2-容器数据卷-volumes"><a href="#_2-5-2-容器数据卷-volumes" class="header-anchor">#</a> 2.5.2 容器数据卷(Volumes)</h4> <p>​        DVolumes是目录（或者文件），它们是外部默认的联合文件系统或者是存在于宿主文件系统正常的目录和文件，<strong>能够持久数据以及共享容器间的数据</strong>。通俗地来说，docker容器数据卷可以看成是生活中常用的u盘，它存在于一个或多个的容器中，由docker挂载到容器，但不属于联合文件系统，Docker不会在容器删除时删除其挂载的数据卷。</p> <p>特点：</p> <ul><li><p>数据卷可以在容器之间共享或重用数据</p></li> <li><p>数据卷中的更改可以直接生效</p></li> <li><p>数据卷中的更改不会包含在镜像的更新中</p></li> <li><p>数据卷的生命周期一直持续到没有容器使用它为止</p></li></ul> <h4 id="_2-5-3-添加数据卷"><a href="#_2-5-3-添加数据卷" class="header-anchor">#</a> 2.5.3 添加数据卷</h4> <ol><li><p>命令添加，创建容器时在容器内添加数据卷：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> run -it -v /宿主机绝对路径:/容器内目录 镜像名
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ol> <ul><li><p>将宿主机的目录与容器内的目录进行映射，这样就可以通过修改宿主机某个目录的文件从而去影响容器。把容器关掉，修改宿主机的目录，再次启动容器时，也会同步。</p></li> <li><p>如果共享的是多级的目录，可能会出现权限不足的提示。这是因为CentOS7中的安全模块selinux把权限禁掉了，需要添加参数  --privileged=true  来解决挂载的目录没有权限的问题。</p></li> <li><p>-v 主机目录:容器目录这种方法不能够直接在Dockerfile中实现，因为并不能够保证在所有的宿主机上都存在这样的特定目录。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> inspect 容器id  <span class="token comment">#查看是否挂载成功</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul> <ol start="2"><li><p>DockerFile添加：</p> <ul><li>容器下新建一个文件夹mydocker，编辑Dockerfile文件，添加两个数据卷;</li> <li>执行，获得一个新的镜像;</li> <li>宿主机的默认路径可以用<code>docker inspect 容器id</code>指令查看</li></ul></li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>   <span class="token comment">#容器下新建一个文件夹mydocker，编辑Dockerfile文件，添加两个数据卷</span>
   <span class="token function">vim</span> Dockerfile
   
   FROM centos    <span class="token comment">#来源于镜像centos</span>
   VOLUME <span class="token punctuation">[</span><span class="token string">&quot;/dataVolumeContainer1&quot;</span>,<span class="token string">&quot;/dataVolumeContainer2&quot;</span><span class="token punctuation">]</span>  <span class="token comment">#添加两个数据卷</span>
   CMD <span class="token builtin class-name">echo</span> <span class="token string">&quot;finished,--------success1&quot;</span> <span class="token comment">#容器卷运行成功提示</span>
   CMD /bin/bash
   <span class="token comment">#---------------------------</span>
   <span class="token comment">#以上指令相当于:</span>
   <span class="token function">docker</span> run -it -v /host1:/dataVolumeContainer1 /host2:/dataVolumeContainer2 centos /bin/bash
   
   <span class="token comment">#执行，获得一个新的镜像</span>
   <span class="token function">docker</span> bulid -f /mydocker/Dockerfile -t 自定义镜像名
   
   <span class="token comment">#宿主机的默认路径可以用docker inspect 容器id指令查看</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="_2-6-dockerfile"><a href="#_2-6-dockerfile" class="header-anchor">#</a> 2.6 Dockerfile</h3> <h4 id="_2-6-1-概念"><a href="#_2-6-1-概念" class="header-anchor">#</a> 2.6.1 概念</h4> <p>Dockerfile是由一系列命令和参数构成的脚本，这些命令应用于基础镜像并最终创建一个新的镜像。</p> <ol><li>对于开发人员：可以为开发团队提供一个完全一致的开发环境；</li> <li>对于测试人员：可以直接拿开发时所构建的镜像或者通过Dockerfile文件构建一个新的镜像开始工作了；</li> <li>对于运维人员：在部署时，可以实现应用的无缝移植</li></ol> <p>区分几个概念：</p> <ul><li><p>Dockerfile，需要定义一个Dockerfile，Dockerfile定义了进程需要的一切东西。Dockerfile涉及的内容包括执行代码或者是文件、环境变量、依赖包、运行时环境、动态链接库、操作系统的发行版、服务进程和内核进程(当应用进程需要和系统服务和内核进程打交道，这时需要考虑如何设计namespace的权限控制)等等;</p></li> <li><p>Docker镜像，在用Dockerfile定义一个文件之后，docker build时会产生一个Docker镜像，当运行 Docker镜像时，会真正开始提供服务;</p></li> <li><p>Docker容器，容器是直接提供服务的。</p></li></ul> <h4 id="_2-6-2-常用命令"><a href="#_2-6-2-常用命令" class="header-anchor">#</a> 2.6.2 常用命令</h4> <table><thead><tr><th>命令</th> <th>作用</th></tr></thead> <tbody><tr><td>FROM image_name:tag</td> <td>定义了使用哪个基础镜像启动构建流程</td></tr> <tr><td>MAINTAINER user_name</td> <td>声明镜像的创建者</td></tr> <tr><td>ENV key value</td> <td>设置环境变量 (可以写多条)</td></tr> <tr><td>RUN command</td> <td>是Dockerfile的核心部分(可以写多条)</td></tr> <tr><td>EXPOSE</td> <td>当前容器对外暴露出的端口</td></tr> <tr><td>ADD source_dir/file dest_dir/file</td> <td>将宿主机的文件复制到容器内，如果是一个压缩文件，将会在复制后自动解压</td></tr> <tr><td>COPY source_dir/file dest_dir/file</td> <td>和ADD相似，但是如果有压缩文件并不能解压</td></tr> <tr><td>VOLUME</td> <td>容器数据卷，用于数据保持和持久化工作</td></tr> <tr><td>CMD</td> <td>指定一个容器启动时要运行的命令，Dockerfile中可以有多个CMD指令，但只有最后一个生效，CMD会被docker run之后的参数替代</td></tr> <tr><td>ENTRYPOINT</td> <td>指定一个容器启动时要运行的命令，docker run之后的会追加</td></tr> <tr><td>WORKDIR path_dir</td> <td>设置工作目录</td></tr></tbody></table> <h3 id="_2-7-centos镜像案例"><a href="#_2-7-centos镜像案例" class="header-anchor">#</a> 2.7 centos镜像案例</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>FROM scratch    <span class="token comment">#依赖镜像名称和ID</span>
MAINTAINER <span class="token punctuation">..</span>.   <span class="token comment">#指定镜像创建者信息</span>
ADD centos-7-x86_64-docker.tar.xz /    <span class="token comment">#执对容器作出修改</span>

LABEL org.label-schema.schema-version<span class="token operator">=</span><span class="token string">&quot;1.0&quot;</span> <span class="token punctuation">\</span>
    org.label-schema.name<span class="token operator">=</span><span class="token string">&quot;CentOS Base Image&quot;</span> <span class="token punctuation">\</span>
    org.label-schema.vendor<span class="token operator">=</span><span class="token string">&quot;CentOS&quot;</span> <span class="token punctuation">\</span>
    org.label-schema.license<span class="token operator">=</span><span class="token string">&quot;GPLv2&quot;</span> <span class="token punctuation">\</span>
    org.label-schema.build-date<span class="token operator">=</span><span class="token string">&quot;20191001&quot;</span>

CMD <span class="token punctuation">[</span><span class="token string">&quot;/bin/bash&quot;</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="_3-应用部署"><a href="#_3-应用部署" class="header-anchor">#</a> 3. 应用部署</h2> <h3 id="_3-1-tomcat部署"><a href="#_3-1-tomcat部署" class="header-anchor">#</a> 3.1 Tomcat部署</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> search tomcat   <span class="token comment">#搜索Tomcat镜像</span>
<span class="token function">docker</span> pull tomcat    <span class="token comment">#拉取tomcat镜像</span>
<span class="token function">docker</span> run -it -p <span class="token number">8080</span>:8080 tomcat  <span class="token comment">#交互式方式创建容器，-p表示端口映射，前者是宿主机端口，后者是容器内的映射端口</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>最新版本的webapp目录下没有页面，浏览器连接会显示404。</p> <h3 id="_3-2-mysql部署"><a href="#_3-2-mysql部署" class="header-anchor">#</a> 3.2 MySQL部署</h3> <ol><li>拉取镜像</li></ol> <div class="language-SHELL line-numbers-mode"><pre class="language-shell"><code>   <span class="token function">docker</span> pull mysql:5.7   <span class="token comment">#拉取mysql:5.7镜像</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="2"><li>创建容器，设置端口映射、目录映射</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 在/root目录下创建mysql目录用于存储mysql数据信息</span>
<span class="token function">mkdir</span> ~/mysql
<span class="token builtin class-name">cd</span> ~/mysql

<span class="token function">docker</span> run -p <span class="token number">12345</span>:3306 --name mysql -v /root/mysql/conf:/etc/mysql/conf.d -v /root/mysql/logs:/logs -v /root/mysql/data:/var/lib/mysql -e <span class="token assign-left variable">MYSQL_ROOT_PASSWORD</span><span class="token operator">=</span><span class="token number">123456</span> -d mysql:5.7 

<span class="token function">docker</span> <span class="token builtin class-name">exec</span> –it 容器id /bin/bash  <span class="token comment">#进入容器，操作mysql</span>
mysql -uroot -p123456  <span class="token comment">#进入mysql命令操作</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ol start="3"><li>数据备份：</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#所有的数据库文件导出到宿主机的/root/mysql/all-databases.sql文件备份</span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> 容器ID <span class="token function">sh</span> -c <span class="token string">' exec mysqldump --all-databases -uroot -p&quot;123456&quot; '</span> <span class="token operator">&gt;</span> /root/mysql/all-databases.sql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_3-3-redis部署"><a href="#_3-3-redis部署" class="header-anchor">#</a> 3.3 Redis部署</h3> <ol><li>搜索redis镜像</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> search redis
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="2"><li>拉取redis镜像</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> pull redis:3.2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="3"><li>创建容器，设置端口映射</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> run -p <span class="token number">6379</span>:6379 -v /root/redis/data:/data -v /root/redis/conf/redis.conf:/usr/local/etc/redis/redis.conf -d redis:3.2 redis-server /usr/local/etc/redis/redis.conf --appendonly <span class="token function">yes</span>  <span class="token comment">#开启aof</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="4"><li>测试连接</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> <span class="token builtin class-name">exec</span> -it 容器ID  redis-cli
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_3-4-ngnix部署"><a href="#_3-4-ngnix部署" class="header-anchor">#</a> 3.4 Ngnix部署</h3> <ol><li>搜索nginx镜像</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> search nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="2"><li>拉取nginx镜像</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> pull nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="3"><li>创建容器，设置端口映射、目录映射</li></ol> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 在/root目录下创建nginx目录用于存储nginx数据信息</span>
<span class="token function">mkdir</span> ~/nginx
<span class="token builtin class-name">cd</span> ~/nginx
<span class="token function">mkdir</span> conf
<span class="token builtin class-name">cd</span> conf
<span class="token comment"># 在~/nginx/conf/下创建nginx.conf文件,粘贴下面内容</span>
<span class="token function">vim</span> nginx.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code>
user  nginx<span class="token punctuation">;</span>
worker_processes  <span class="token number">1</span><span class="token punctuation">;</span>

error_log  /var/log/nginx/error.log warn<span class="token punctuation">;</span>
pid        /var/run/nginx.pid<span class="token punctuation">;</span>


events <span class="token punctuation">{</span>
    worker_connections  <span class="token number">1024</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


http <span class="token punctuation">{</span>
    include       /etc/nginx/mime.types<span class="token punctuation">;</span>
    default_type  application/octet-stream<span class="token punctuation">;</span>

    log_format  main  <span class="token string">'$remote_addr - $remote_user [$time_local] &quot;$request&quot; '</span>
                      <span class="token string">'$status $body_bytes_sent &quot;$http_referer&quot; '</span>
                      <span class="token string">'&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;'</span><span class="token punctuation">;</span>

    access_log  /var/log/nginx/access.log  main<span class="token punctuation">;</span>

    sendfile        on<span class="token punctuation">;</span>
    <span class="token comment">#tcp_nopush     on;</span>

    keepalive_timeout  <span class="token number">65</span><span class="token punctuation">;</span>

    <span class="token comment">#gzip  on;</span>

    include /etc/nginx/conf.d/*.conf<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">docker</span> run -id --name<span class="token operator">=</span>c_nginx -p <span class="token number">80</span>:80  -v /root/nginx/conf/nginx.conf:/etc/nginx/nginx.conf -v /root/nginx/conf/logs:/var/log/nginx -v /root/nginx/conf/html:/usr/share/nginx/html nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ol start="4"><li>使用外部机器访问nginx</li></ol></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">8/14/2022, 12:13:51 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/study-note/assets/js/app.73f4c6b1.js" defer></script><script src="/study-note/assets/js/2.a46c0893.js" defer></script><script src="/study-note/assets/js/45.d7d79e6d.js" defer></script>
  </body>
</html>
